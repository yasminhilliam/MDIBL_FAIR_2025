"1","<!-- KNITR_ASIS_OUTPUT_TOKEN -->
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuYWxsRGYgJT4lXG4gIGxlZnRfam9pbiguLGVucm9sbG1lbnRfZGF0YSkgJT4lXG4gIGxlZnRfam9pbiguLHNpbnNwdV9kYXRhKSAlPiVcbiAgbGVmdF9qb2luKC4sY24pICU+JVxuICBmaWx0ZXIoZ2VudXMgPT0gXCJQc2V1ZG9tb25hc1wiKSAlPiVcbiAgbXV0YXRlKFBzZXVkb19hYiA9IG1lYW5fY24qKHJlbF9hYi8xMDApLzQpICU+JVxuICBnZ3Bsb3QoYWVzKHggPSBzZXgsXG4gICAgICAgICAgICAgeSA9IHJlbF9hYixcbiAgICAgICAgICAgICBjb2xvciA9IHNleCkpICtcbiAgZ2VvbV92aW9saW4oZHJhd19xdWFudGlsZXMgPSBjKDAuNSkpICtcbiAgZ2VvbV9qaXR0ZXIod2lkdGggPSAwLjEsXG4gICAgICAgICAgICAgIHNpemUgPSA1LFxuICAgICAgICAgICAgICBhbHBoYSA9IDAuNSkgK1xuICBzY2FsZV9jb2xvcl9tYW51YWwodmFsdWVzID0gYyhcInBsdW0zXCIsXCJyb3lhbGJsdWUzXCIpKSArXG4gIHNjYWxlX3hfZGlzY3JldGUobGFiZWxzID0gYyhcIk5lZ2F0aXZlXCIsXCJQb3NpdGl2ZVwiKSkgK1xuICBsYWJzKHggPSBcIlNhbXBsZSB2aXJhbCBzdGF0dXNcIixcbiAgICAgICB5ID0gXCIqUHNldWRvbW9uYXMqIHJlbGF0aXZlIGFidW5kYW5jZVwiKSArXG4gIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9IFwibm9uZVwiLFxuICAgICAgICBzdHJpcC5iYWNrZ3JvdW5kID0gZWxlbWVudF9ibGFuaygpLFxuICAgICAgICBheGlzLnRpdGxlLnkgPSBlbGVtZW50X21hcmtkb3duKCkpIC0+IHNleHBsb3RcblxuZ2dzYXZlKHBsb3QgPSBzZXhwbG90LFxuICAgICAgIFwicHNldWRvX3JlbF9hYl9zZXgucGRmXCIsXG4gICAgICAgaGVpZ2h0ID0gOCxcbiAgICAgICB3aWR0aCA9IDEyLFxuICAgICAgIHVuaXRzID0gYyhcImluXCIpKVxuXG5cbmFsbERmICU+JVxuICBmaWx0ZXIoaW5kZXggJWluJSBzaW5zcHUpICU+JVxuICBsZWZ0X2pvaW4oLixlbnJvbGxtZW50X2RhdGEpICU+JVxuICBsZWZ0X2pvaW4oLixzaW5zcHVfZGF0YSkgJT4lXG4gIGxlZnRfam9pbiguLGNuKSAlPiVcbiAgZmlsdGVyKGdlbnVzID09IFwiUHNldWRvbW9uYXNcIikgJT4lXG4gIG11dGF0ZShQc2V1ZG9fYWIgPSBtZWFuX2NuKihyZWxfYWIvMTAwKS80KSAlPiVcbiAgZ2dwbG90KGFlcyh4ID0gdmlydXMuYmluLFxuICAgICAgICAgICAgIHkgPSByZWxfYWIsXG4gICAgICAgICAgICAgY29sb3IgPSBhcy5mYWN0b3IoYWxsZXJnaWNfcmhpbml0aXMpKSkgK1xuICBnZW9tX2JveHBsb3Qob3V0bGllcnMgPSBGQUxTRSkgK1xuICBnZW9tX2ppdHRlcih3aWR0aCA9IDAuMSxcbiAgICAgICAgICAgICAgc2l6ZSA9IDUsXG4gICAgICAgICAgICAgIGFscGhhID0gMC41KSArXG4gIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSBjKFwiZGFya2JsdWVcIixcImRvZGdlcmJsdWVcIikpICtcbiAgc2NhbGVfeV9jb250aW51b3VzKGxpbWl0cyA9IGMoLTEsMTA1KSxcbiAgICAgICAgICAgICAgICAgICAgIGJyZWFrcyA9IGMoMCwyNSw1MCw3NSwxMDApKSArXG4gIHNjYWxlX3hfZGlzY3JldGUobGFiZWxzID0gYyhcIk5lZ2F0aXZlXCIsXCJQb3NpdGl2ZVwiKSkgK1xuICBsYWJzKHggPSBcIlNhbXBsZSB2aXJhbCBzdGF0dXNcIixcbiAgICAgICB5ID0gXCIqUHNldWRvbW9uYXMqIHJlbGF0aXZlIGFidW5kYW5jZVwiKSArXG4gIGZhY2V0X3dyYXAofmFsbGVyZ2ljX3JoaW5pdGlzLFxuICAgICAgICAgICAgIGxhYmVsbGVyID0gYXNfbGFiZWxsZXIoYyhcIjBcIj1cIk5vIEFSXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiMVwiPVwiQVJcIikpKSArXG4gIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9IFwibm9uZVwiLFxuICAgICAgICBheGlzLnRpdGxlLnkgPSBlbGVtZW50X21hcmtkb3duKCksXG4gICAgICAgIHN0cmlwLmJhY2tncm91bmQgPSBlbGVtZW50X2JsYW5rKCkpIC0+IEFScGxvdFxuXG5nZ3NhdmUocGxvdCA9IEFScGxvdCxcbiAgICAgICBcInBzZXVkb19yZWxfYWJfQVIucGRmXCIsXG4gICAgICAgaGVpZ2h0ID0gOCxcbiAgICAgICB3aWR0aCA9IDEyLFxuICAgICAgIHVuaXRzID0gYyhcImluXCIpKVxuXG5hbGxEZiAlPiVcbiAgZmlsdGVyKHZpcnVzLmJpbiA9PSAxKSAlPiVcbiAgZHBseXI6OnNlbGVjdChwYXRpZW50aWQpICU+JVxuICBkaXN0aW5jdCgpICU+JVxuICAuJHBhdGllbnRpZCAtPiB2aXJwYXRpZW50XG5cbmFsbERmICU+JVxuICBsZWZ0X2pvaW4oLixlbnJvbGxtZW50X2RhdGEpICU+JVxuICBsZWZ0X2pvaW4oLixzaW5zcHVfZGF0YSkgJT4lXG4gIGxlZnRfam9pbiguLGNuKSAlPiVcbiAgZmlsdGVyKHBhdGllbnRpZCAlaW4lIHZpcnBhdGllbnQpICU+JVxuICBmaWx0ZXIoaW5kZXggJWluJSBzaW5zcHUpICU+JVxuICBmaWx0ZXIoZ2VudXMgPT0gXCJQc2V1ZG9tb25hc1wiKSAlPiVcbiAgbXV0YXRlKFBzZXVkb19hYiA9IG1lYW5fY24qKHJlbF9hYi8xMDApLzQpICU+JVxuICBnZ3Bsb3QoYWVzKHggPSBhZ2UsXG4gICAgICAgICAgICAgeSA9IHJlbF9hYixcbiAgICAgICAgICAgICBjb2xvciA9IHZpcnVzLmJpbikpICtcbiAgZ2VvbV9zbW9vdGgobWV0aG9kID0gXCJsbVwiLFxuICAgICAgICAgICAgICBzZSA9IEZBTFNFKSArXG4gIGdlb21fcG9pbnQoc2l6ZSA9IDUsXG4gICAgICAgICAgICAgYWxwaGEgPSAwLjUpICtcbiAgc2NhbGVfY29sb3JfbWFudWFsKG5hbWUgPSBcIlNhbXBsZSB2aXJhbFxcbnN0YXR1c1wiLFxuICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gdmlyY29scyxcbiAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IGMoXCJOZWdhdGl2ZVwiLFwiUG9zaXRpdmVcIikpICtcbiAgbGFicyh4ID0gXCJBZ2UgYXQgZW5yb2xsbWVudFwiLFxuICAgICAgIHkgPSBcIipQc2V1ZG9tb25hcyogcmVsYXRpdmUgYWJ1bmRhbmNlXCIpICtcbiAgdGhlbWUoYXhpcy50aXRsZS55ID0gZWxlbWVudF9tYXJrZG93bigpLFxuICAgICAgICBzdHJpcC5iYWNrZ3JvdW5kID0gZWxlbWVudF9ibGFuaygpLFxuICAgICAgICBsZWdlbmQucG9zaXRpb24gPSBcImluc2lkZVwiLFxuICAgICAgICBsZWdlbmQucG9zaXRpb24uaW5zaWRlID0gYygwLjg1LDAuOCksXG4gICAgICAgIGxlZ2VuZC5iYWNrZ3JvdW5kID0gZWxlbWVudF9yZWN0KGNvbG9yID0gXCJibGFja1wiKSkgLT4gYWdlcGxvdFxuXG5nZ3NhdmUocGxvdCA9IGFnZXBsb3QsXG4gICAgICAgXCJwc2V1ZG9fcmVsX2FiX2FnZS5wZGZcIixcbiAgICAgICBoZWlnaHQgPSA4LFxuICAgICAgIHdpZHRoID0gMTIsXG4gICAgICAgdW5pdHMgPSBjKFwiaW5cIikpXG5cbmFsbERmICU+JVxuICBmaWx0ZXIocGF0aWVudGlkICVpbiUgdmlycGF0aWVudCkgJT4lXG4gIGZpbHRlcihpbmRleCAlaW4lIHNpbnNwdSkgJT4lXG4gIGxlZnRfam9pbiguLGVucm9sbG1lbnRfZGF0YSkgJT4lXG4gIGxlZnRfam9pbiguLHNpbnNwdV9kYXRhKSAlPiVcbiAgbGVmdF9qb2luKC4sY24pICU+JVxuICBmaWx0ZXIoZ2VudXMgPT0gXCJQc2V1ZG9tb25hc1wiKSAlPiVcbiAgZHBseXI6OnNlbGVjdChpbmRleCxwYXRpZW50aWQsc2V4LHJlbF9hYix2aXJ1cy5iaW4pICU+JVxuICBkaXN0aW5jdCgpIC0+IHBzZXVkb19kYXRhXG5cbmxtZXIoZGF0YSA9IHBzZXVkb19kYXRhLFxuICAgICByZWxfYWIgfiAodmlydXMuYmluKnNleCkgKyAoMXxwYXRpZW50aWQpKSAtPiBwc2V1ZG9MTVxuXG5zdW1tYXJ5KHBzZXVkb0xNKVxuXG5hbm92YShwc2V1ZG9MTSlcblxuZW1tZWFucyhwc2V1ZG9MTSxjKFwic2V4XCIsXCJ2aXJ1cy5iaW5cIikpIC0+IHBzZXVkb0VtbVxuXG5jb250cmFzdChwc2V1ZG9FbW0sJ3R1a2V5JylcbmBgYCJ9 -->

```r
allDf %>%
  left_join(.,enrollment_data) %>%
  left_join(.,sinspu_data) %>%
  left_join(.,cn) %>%
  filter(genus == \"Pseudomonas\") %>%
  mutate(Pseudo_ab = mean_cn*(rel_ab/100)/4) %>%
  ggplot(aes(x = sex,
             y = rel_ab,
             color = sex)) +
  geom_violin(draw_quantiles = c(0.5)) +
  geom_jitter(width = 0.1,
              size = 5,
              alpha = 0.5) +
  scale_color_manual(values = c(\"plum3\",\"royalblue3\")) +
  scale_x_discrete(labels = c(\"Negative\",\"Positive\")) +
  labs(x = \"Sample viral status\",
       y = \"*Pseudomonas* relative abundance\") +
  theme(legend.position = \"none\",
        strip.background = element_blank(),
        axis.title.y = element_markdown()) -> sexplot

ggsave(plot = sexplot,
       \"pseudo_rel_ab_sex.pdf\",
       height = 8,
       width = 12,
       units = c(\"in\"))


allDf %>%
  filter(index %in% sinspu) %>%
  left_join(.,enrollment_data) %>%
  left_join(.,sinspu_data) %>%
  left_join(.,cn) %>%
  filter(genus == \"Pseudomonas\") %>%
  mutate(Pseudo_ab = mean_cn*(rel_ab/100)/4) %>%
  ggplot(aes(x = virus.bin,
             y = rel_ab,
             color = as.factor(allergic_rhinitis))) +
  geom_boxplot(outliers = FALSE) +
  geom_jitter(width = 0.1,
              size = 5,
              alpha = 0.5) +
  scale_color_manual(values = c(\"darkblue\",\"dodgerblue\")) +
  scale_y_continuous(limits = c(-1,105),
                     breaks = c(0,25,50,75,100)) +
  scale_x_discrete(labels = c(\"Negative\",\"Positive\")) +
  labs(x = \"Sample viral status\",
       y = \"*Pseudomonas* relative abundance\") +
  facet_wrap(~allergic_rhinitis,
             labeller = as_labeller(c(\"0\"=\"No AR\",
                                      \"1\"=\"AR\"))) +
  theme(legend.position = \"none\",
        axis.title.y = element_markdown(),
        strip.background = element_blank()) -> ARplot

ggsave(plot = ARplot,
       \"pseudo_rel_ab_AR.pdf\",
       height = 8,
       width = 12,
       units = c(\"in\"))

allDf %>%
  filter(virus.bin == 1) %>%
  dplyr::select(patientid) %>%
  distinct() %>%
  .$patientid -> virpatient

allDf %>%
  left_join(.,enrollment_data) %>%
  left_join(.,sinspu_data) %>%
  left_join(.,cn) %>%
  filter(patientid %in% virpatient) %>%
  filter(index %in% sinspu) %>%
  filter(genus == \"Pseudomonas\") %>%
  mutate(Pseudo_ab = mean_cn*(rel_ab/100)/4) %>%
  ggplot(aes(x = age,
             y = rel_ab,
             color = virus.bin)) +
  geom_smooth(method = \"lm\",
              se = FALSE) +
  geom_point(size = 5,
             alpha = 0.5) +
  scale_color_manual(name = \"Sample viral\nstatus\",
                     values = vircols,
                     labels = c(\"Negative\",\"Positive\")) +
  labs(x = \"Age at enrollment\",
       y = \"*Pseudomonas* relative abundance\") +
  theme(axis.title.y = element_markdown(),
        strip.background = element_blank(),
        legend.position = \"inside\",
        legend.position.inside = c(0.85,0.8),
        legend.background = element_rect(color = \"black\")) -> ageplot

ggsave(plot = ageplot,
       \"pseudo_rel_ab_age.pdf\",
       height = 8,
       width = 12,
       units = c(\"in\"))

allDf %>%
  filter(patientid %in% virpatient) %>%
  filter(index %in% sinspu) %>%
  left_join(.,enrollment_data) %>%
  left_join(.,sinspu_data) %>%
  left_join(.,cn) %>%
  filter(genus == \"Pseudomonas\") %>%
  dplyr::select(index,patientid,sex,rel_ab,virus.bin) %>%
  distinct() -> pseudo_data

lmer(data = pseudo_data,
     rel_ab ~ (virus.bin*sex) + (1|patientid)) -> pseudoLM

summary(pseudoLM)

anova(pseudoLM)

emmeans(pseudoLM,c(\"sex\",\"virus.bin\")) -> pseudoEmm

contrast(pseudoEmm,'tukey')
```

<!-- rnb-source-end -->
<!-- KNITR_ASIS_OUTPUT_TOKEN -->"
"0","```r
allDf %>%
  left_join(.,enrollment_data) %>%
  left_join(.,sinspu_data) %>%
  left_join(.,cn) %>%
  filter(genus == \"Pseudomonas\") %>%
  mutate(Pseudo_ab = mean_cn*(rel_ab/100)/4) %>%
  ggplot(aes(x = sex,
             y = rel_ab,
             color = sex)) +
  geom_violin(draw_quantiles = c(0.5)) +
  geom_jitter(width = 0.1,
              size = 5,
              alpha = 0.5) +
  scale_color_manual(values = c(\"plum3\",\"royalblue3\")) +
  scale_x_discrete(labels = c(\"Negative\",\"Positive\")) +
  labs(x = \"Sample viral status\",
       y = \"*Pseudomonas* relative abundance\") +
  theme(legend.position = \"none\",
        strip.background = element_blank(),
        axis.title.y = element_markdown()) -> sexplot

ggsave(plot = sexplot,
       \"pseudo_rel_ab_sex.pdf\",
       height = 8,
       width = 12,
       units = c(\"in\"))


allDf %>%
  filter(index %in% sinspu) %>%
  left_join(.,enrollment_data) %>%
  left_join(.,sinspu_data) %>%
  left_join(.,cn) %>%
  filter(genus == \"Pseudomonas\") %>%
  mutate(Pseudo_ab = mean_cn*(rel_ab/100)/4) %>%
  ggplot(aes(x = virus.bin,
             y = rel_ab,
             color = as.factor(allergic_rhinitis))) +
  geom_boxplot(outliers = FALSE) +
  geom_jitter(width = 0.1,
              size = 5,
              alpha = 0.5) +
  scale_color_manual(values = c(\"darkblue\",\"dodgerblue\")) +
  scale_y_continuous(limits = c(-1,105),
                     breaks = c(0,25,50,75,100)) +
  scale_x_discrete(labels = c(\"Negative\",\"Positive\")) +
  labs(x = \"Sample viral status\",
       y = \"*Pseudomonas* relative abundance\") +
  facet_wrap(~allergic_rhinitis,
             labeller = as_labeller(c(\"0\"=\"No AR\",
                                      \"1\"=\"AR\"))) +
  theme(legend.position = \"none\",
        axis.title.y = element_markdown(),
        strip.background = element_blank()) -> ARplot

ggsave(plot = ARplot,
       \"pseudo_rel_ab_AR.pdf\",
       height = 8,
       width = 12,
       units = c(\"in\"))

allDf %>%
  filter(virus.bin == 1) %>%
  dplyr::select(patientid) %>%
  distinct() %>%
  .$patientid -> virpatient

allDf %>%
  left_join(.,enrollment_data) %>%
  left_join(.,sinspu_data) %>%
  left_join(.,cn) %>%
  filter(patientid %in% virpatient) %>%
  filter(index %in% sinspu) %>%
  filter(genus == \"Pseudomonas\") %>%
  mutate(Pseudo_ab = mean_cn*(rel_ab/100)/4) %>%
  ggplot(aes(x = age,
             y = rel_ab,
             color = virus.bin)) +
  geom_smooth(method = \"lm\",
              se = FALSE) +
  geom_point(size = 5,
             alpha = 0.5) +
  scale_color_manual(name = \"Sample viral\nstatus\",
                     values = vircols,
                     labels = c(\"Negative\",\"Positive\")) +
  labs(x = \"Age at enrollment\",
       y = \"*Pseudomonas* relative abundance\") +
  theme(axis.title.y = element_markdown(),
        strip.background = element_blank(),
        legend.position = \"inside\",
        legend.position.inside = c(0.85,0.8),
        legend.background = element_rect(color = \"black\")) -> ageplot

ggsave(plot = ageplot,
       \"pseudo_rel_ab_age.pdf\",
       height = 8,
       width = 12,
       units = c(\"in\"))

allDf %>%
  filter(patientid %in% virpatient) %>%
  filter(index %in% sinspu) %>%
  left_join(.,enrollment_data) %>%
  left_join(.,sinspu_data) %>%
  left_join(.,cn) %>%
  filter(genus == \"Pseudomonas\") %>%
  dplyr::select(index,patientid,sex,rel_ab,virus.bin) %>%
  distinct() -> pseudo_data

lmer(data = pseudo_data,
     rel_ab ~ (virus.bin*sex) + (1|patientid)) -> pseudoLM

summary(pseudoLM)

anova(pseudoLM)

emmeans(pseudoLM,c(\"sex\",\"virus.bin\")) -> pseudoEmm

contrast(pseudoEmm,'tukey')
```"
