"1","<!-- KNITR_ASIS_OUTPUT_TOKEN -->
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuZ3N1YihcIihHRVNDRlxcXFxkezJ9KV9cXFxcUytcIixcIlxcXFwxXCIsc2luc3B1UENvQU1ldGEkaW5kZXgpIC0+IHNpbnNwdVBDb0FNZXRhJHBhdGllbnRpZFxuXG5sZWZ0X2pvaW4oc2luc3B1UENvQU1ldGEsbl92aXJ1c2VzKSAlPiVcbiAgbXV0YXRlKG51bWJlcl92aXJ1c2VzID0gaWZfZWxzZShpcy5uYShudW1iZXJfdmlydXNlcyksMCxudW1iZXJfdmlydXNlcykpICU+JVxuICBtdXRhdGUodmlzaXQgPSBjYXNlX3doZW4oaW5kZXggJWluJSBmaXJzdF92aXNpdHMgfiBcImZpcnN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCAlaW4lIGxhc3RfdmlzaXRzIH4gXCJsYXN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBUUlVFIH4gXCJvdGhlclwiKSkgJT4lXG4gIGdncGxvdChhZXMoeCA9IERpbTEsXG4gICAgICAgICAgICAgeSA9IERpbTIsXG4gICAgICAgICAgICAgY29sb3IgPSBhcy5mYWN0b3IobnVtYmVyX3ZpcnVzZXMpLFxuICAgICAgICAgICAgIHNoYXBlID0gdmlzaXQpKSArXG4gIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAsXG4gICAgICAgICAgICAgY29sb3IgPSBcImdyZXlcIikgK1xuICBnZW9tX3ZsaW5lKHhpbnRlcmNlcHQgPSAwLFxuICAgICAgICAgICAgIGNvbG9yID0gXCJncmV5XCIpICtcbiAgZ2VvbV9wb2ludChzaXplID0gNSxcbiAgICAgICAgICAgICBhbHBoYSA9IDAuNykgK1xuICBzY2FsZV9jb2xvcl9tYW51YWwobmFtZSA9IFwiUlZJcyBwZXIgc3ViamVjdFxcbnBlciBzYW1wbGUgc2l0ZVwiLFxuICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gYyhcIiNDMENFRDFGRlwiLFwiIzNFOTJFMEZGXCIsXCIjMkEzRjZFRkZcIixcIiNGQ0QzNEJGRlwiKSkgK1xuICBzY2FsZV9zaGFwZV9tYW51YWwobmFtZSA9IFwiVmlzaXRcIixcbiAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IGMoMTYsMTcsMSksXG4gICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBjKFwiRmlyc3RcIixcIkZpbmFsXCIsXCJJbnRlcm1lZGlhdGVcIikpICtcbiAgc2NhbGVfeF9jb250aW51b3VzKGxpbWl0cyA9IGMoLTAuNywwLjcpKSArXG4gIHNjYWxlX3lfY29udGludW91cyhsaW1pdHMgPSBjKC0wLjY1LDAuNjUpKSArXG4gIGxhYnMoeCA9IFwiUENvQSAxICg1MC42JSlcIixcbiAgICAgICB5ID0gXCJQQ29BIDIgKDI2LjIlKVwiKSArXG4gIHRoZW1lKGxlZ2VuZC50ZXh0ID0gZWxlbWVudF9tYXJrZG93bigpLFxuICAgICAgICBsZWdlbmQuYmFja2dyb3VuZCA9IGVsZW1lbnRfcmVjdChjb2xvciA9IFwiYmxhY2tcIiksXG4gICAgICAgIGxlZ2VuZC5wb3NpdGlvbiA9IFwiaW5zaWRlXCIsXG4gICAgICAgIGxlZ2VuZC5wb3NpdGlvbi5pbnNpZGUgPSBjKDAuMTIsMC43NyksXG4gICAgICAgIHBhbmVsLmdyaWQgPSBlbGVtZW50X2JsYW5rKCkpIC0+IG52aXJ1c1BDb0FcblxuZ2dzYXZlKHBsb3QgPSBudmlydXNQQ29BLFxuICAgICAgIFwiYWR1bHRfUENvQV9udW1iZXJfdmlydXNlcy5wZGZcIixcbiAgICAgICBoZWlnaHQgPSA4LFxuICAgICAgIHdpZHRoID0gMTAsXG4gICAgICAgdW5pdHMgPSBjKFwiaW5cIikpXG5cbnBsb3RfZ3JpZChudmlydXNQQ29BLG1vc3RhYlBDb0EpIC0+IG52aXJ1c21vc3RhYlxuXG5nZ3NhdmUocGxvdCA9IG52aXJ1c21vc3RhYixcbiAgICAgICBcImFkdWx0X1BDb0FfbnVtYmVyX3ZpcnVzZXNfbW9zdF9hYnVuZGFudC5wZGZcIixcbiAgICAgICBoZWlnaHQgPSA4LFxuICAgICAgIHdpZHRoID0gMTQsXG4gICAgICAgdW5pdHMgPSBjKFwiaW5cIikpXG5gYGAifQ== -->

```r
gsub(\"(GESCF\\d{2})_\\S+\",\"\\1\",sinspuPCoAMeta$index) -> sinspuPCoAMeta$patientid

left_join(sinspuPCoAMeta,n_viruses) %>%
  mutate(number_viruses = if_else(is.na(number_viruses),0,number_viruses)) %>%
  mutate(visit = case_when(index %in% first_visits ~ \"first\",
                           index %in% last_visits ~ \"last\",
                           TRUE ~ \"other\")) %>%
  ggplot(aes(x = Dim1,
             y = Dim2,
             color = as.factor(number_viruses),
             shape = visit)) +
  geom_hline(yintercept = 0,
             color = \"grey\") +
  geom_vline(xintercept = 0,
             color = \"grey\") +
  geom_point(size = 5,
             alpha = 0.7) +
  scale_color_manual(name = \"RVIs per subject\nper sample site\",
                     values = c(\"#C0CED1FF\",\"#3E92E0FF\",\"#2A3F6EFF\",\"#FCD34BFF\")) +
  scale_shape_manual(name = \"Visit\",
                     values = c(16,17,1),
                     labels = c(\"First\",\"Final\",\"Intermediate\")) +
  scale_x_continuous(limits = c(-0.7,0.7)) +
  scale_y_continuous(limits = c(-0.65,0.65)) +
  labs(x = \"PCoA 1 (50.6%)\",
       y = \"PCoA 2 (26.2%)\") +
  theme(legend.text = element_markdown(),
        legend.background = element_rect(color = \"black\"),
        legend.position = \"inside\",
        legend.position.inside = c(0.12,0.77),
        panel.grid = element_blank()) -> nvirusPCoA

ggsave(plot = nvirusPCoA,
       \"adult_PCoA_number_viruses.pdf\",
       height = 8,
       width = 10,
       units = c(\"in\"))

plot_grid(nvirusPCoA,mostabPCoA) -> nvirusmostab

ggsave(plot = nvirusmostab,
       \"adult_PCoA_number_viruses_most_abundant.pdf\",
       height = 8,
       width = 14,
       units = c(\"in\"))
```

<!-- rnb-source-end -->
<!-- KNITR_ASIS_OUTPUT_TOKEN -->"
"0","```r
gsub(\"(GESCF\\d{2})_\\S+\",\"\\1\",sinspuPCoAMeta$index) -> sinspuPCoAMeta$patientid

left_join(sinspuPCoAMeta,n_viruses) %>%
  mutate(number_viruses = if_else(is.na(number_viruses),0,number_viruses)) %>%
  mutate(visit = case_when(index %in% first_visits ~ \"first\",
                           index %in% last_visits ~ \"last\",
                           TRUE ~ \"other\")) %>%
  ggplot(aes(x = Dim1,
             y = Dim2,
             color = as.factor(number_viruses),
             shape = visit)) +
  geom_hline(yintercept = 0,
             color = \"grey\") +
  geom_vline(xintercept = 0,
             color = \"grey\") +
  geom_point(size = 5,
             alpha = 0.7) +
  scale_color_manual(name = \"RVIs per subject\nper sample site\",
                     values = c(\"#C0CED1FF\",\"#3E92E0FF\",\"#2A3F6EFF\",\"#FCD34BFF\")) +
  scale_shape_manual(name = \"Visit\",
                     values = c(16,17,1),
                     labels = c(\"First\",\"Final\",\"Intermediate\")) +
  scale_x_continuous(limits = c(-0.7,0.7)) +
  scale_y_continuous(limits = c(-0.65,0.65)) +
  labs(x = \"PCoA 1 (50.6%)\",
       y = \"PCoA 2 (26.2%)\") +
  theme(legend.text = element_markdown(),
        legend.background = element_rect(color = \"black\"),
        legend.position = \"inside\",
        legend.position.inside = c(0.12,0.77),
        panel.grid = element_blank()) -> nvirusPCoA

ggsave(plot = nvirusPCoA,
       \"adult_PCoA_number_viruses.pdf\",
       height = 8,
       width = 10,
       units = c(\"in\"))

plot_grid(nvirusPCoA,mostabPCoA) -> nvirusmostab

ggsave(plot = nvirusmostab,
       \"adult_PCoA_number_viruses_most_abundant.pdf\",
       height = 8,
       width = 14,
       units = c(\"in\"))
```"
