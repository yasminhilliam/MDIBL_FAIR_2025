"1","<!-- KNITR_ASIS_OUTPUT_TOKEN -->
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuYWxsRGYgJT4lXG4gIGRwbHlyOjpzZWxlY3QoaW5kZXgsc2FtcGxlbG9jLHZpcnVzLmJpbixPVFUsQWJ1bmRhbmNlKSAlPiVcbiAgZmlsdGVyKCFpcy5uYSh2aXJ1cy5iaW4pKSAlPiVcbiAgZ3JvdXBfYnkoaW5kZXgpICU+JVxuICBzdW1tYXJpc2UoTiA9IHN1bShBYnVuZGFuY2UpKSAlPiVcbiAgYXJyYW5nZShOKSAlPiVcbiAgcHJpbnQobiA9IDIwKSAjIGlkZW50aWZ5IG1pbmltdW0gbnVtYmVyIG9mIHJlYWRzIGZyb20gYSBzYW1wbGUgdG8gYmUgaW5jbHVkZWRcblxuYWxsRGYgJT4lXG4gIGRwbHlyOjpzZWxlY3QoaW5kZXgscGF0aWVudGlkLHNhbXBsZWxvYyx2aXJ1cy5iaW4sT1RVLEFidW5kYW5jZSkgJT4lXG4gIGZpbHRlcighaXMubmEodmlydXMuYmluKSkgJT4lXG4gIGdyb3VwX2J5KGluZGV4KSAlPiUgXG4gIG11dGF0ZShOID0gc3VtKEFidW5kYW5jZSkpICU+JVxuICB1bmdyb3VwKCkgJT4lXG4gIGZpbHRlcihOID49IDEwNDUpICU+JVxuICBkcGx5cjo6c2VsZWN0KC1OKSAlPiVcbiAgcGl2b3Rfd2lkZXIobmFtZXNfZnJvbSA9IFwiT1RVXCIsXG4gICAgICAgICAgICAgIHZhbHVlc19mcm9tID0gXCJBYnVuZGFuY2VcIixcbiAgICAgICAgICAgICAgdmFsdWVzX2ZpbGwgPSAwKSAtPiBzaW5zcHVGaWx0XG5cbnNpbnNwdUZpbHQgJT4lXG4gIGRwbHlyOjpzZWxlY3QoaW5kZXgscGF0aWVudGlkLHNhbXBsZWxvYyx2aXJ1cy5iaW4pIC0+IHNpbnNwdUZpbHRNZXRhXG5cbnNpbnNwdUZpbHQgJT4lXG4gIGRwbHlyOjpzZWxlY3QoLXNhbXBsZWxvYywtdmlydXMuYmluKSAlPiVcbiAgY29sdW1uX3RvX3Jvd25hbWVzKFwiaW5kZXhcIikgJT4lXG4gIGF2Z2Rpc3Qoc2FtcGxlID0gMTA0NSxcbiAgICAgICAgICBkbWV0aG9kID0gXCJob3JuXCIpIC0+IHNpbnNwdURpc3Rcblxuc2luc3B1RGlzdCAlPiVcbiAgaGNsdXN0KG1ldGhvZCA9IFwid2FyZC5EMlwiKSAtPiBzaW5zcHVDbHVzdFxuXG53Y21kc2NhbGUoc2luc3B1RGlzdCxcbiAgICAgICAgICBlaWcgPSBUUlVFKSAtPiBzaW5zcHVQQ29BXG5cbm9yZGlwbG90KHNpbnNwdVBDb0EpXG5cbihzaW5zcHVQQ29BJGVpZ1sxXSAvIHN1bShzaW5zcHVQQ29BJGVpZykpKjEwMCAjIDUwLjYlXG5cbihzaW5zcHVQQ29BJGVpZ1syXSAvIHN1bShzaW5zcHVQQ29BJGVpZykpKjEwMCAjIDI2LjIlXG5cbnNpbnNwdVBDb0EgJT4lXG4gIHNjb3JlcygpICU+JVxuICBhc190aWJibGUocm93bmFtZXMgPSBcImluZGV4XCIpICU+JVxuICBkcGx5cjo6c2VsZWN0KGluZGV4LERpbTEsRGltMikgLT4gc2luc3B1SG9yblBDb0FcblxuaW5uZXJfam9pbihzaW5zcHVGaWx0TWV0YSxzaW5zcHVIb3JuUENvQSkgLT4gc2luc3B1UENvQU1ldGFcblxuc2luc3B1RmlsdE1ldGEgJT4lXG4gIG11dGF0ZShwdF9zYW1wbGVsb2MgPSBwYXN0ZShwYXRpZW50aWQsc2FtcGxlbG9jLHNlcCA9IFwiX1wiKSxcbiAgICAgICAgIC5iZWZvcmUgPSB2aXJ1cy5iaW4pIC0+IHNpbnNwdUZpbHRNZXRhXG5cbmJldGFkaXNwZXIoc2luc3B1RGlzdCxcbiAgICAgICAgICAgZ3JvdXAgPSBhcy5mYWN0b3Ioc2luc3B1RmlsdE1ldGEkcHRfc2FtcGxlbG9jKSxcbiAgICAgICAgICAgdHlwZSA9IFwiY2VudHJvaWRcIikgLT4gc2luc3B1REZDXG5cbnNpbnNwdURGQyA8LSBhcy5kYXRhLmZyYW1lKHNpbnNwdURGQyRkaXN0YW5jZXMpXG5cbnJvd25hbWVzKHNpbnNwdURGQykgLT4gc2luc3B1REZDJGluZGV4XG5cbnNpbnNwdURGQyAlPiVcbiAgZHBseXI6OnJlbmFtZShjZW50cm9pZC5kaXN0YW5jZSA9IDEpIC0+IHNpbnNwdURGQ1xuXG5sZWZ0X2pvaW4oc2luc3B1RmlsdE1ldGEsc2luc3B1REZDKSAtPiBzaW5zcHVERkNcblxuc3VtbWFyeShsbWVyKGRhdGEgPSBzaW5zcHVERkMsXG4gICAgICAgICAgICAgY2VudHJvaWQuZGlzdGFuY2UgfiB2aXJ1cy5iaW4gKyAoMXxwYXRpZW50aWQpKSkgIFxuXG5nZ3Bsb3QoZGF0YSA9IHNpbnNwdURGQyxcbiAgICAgICBhZXMoeCA9IHZpcnVzLmJpbixcbiAgICAgICAgICAgeSA9IGNlbnRyb2lkLmRpc3RhbmNlLFxuICAgICAgICAgICBjb2xvciA9IHZpcnVzLmJpbikpICtcbiAgZ2VvbV9ib3hwbG90KCkgK1xuICBnZW9tX2ppdHRlcih3aWR0aCA9IDAuMSxcbiAgICAgICAgICAgICAgc2l6ZSA9IDUsXG4gICAgICAgICAgICAgIGFscGhhID0gMC41KSArXG4gIHNjYWxlX2NvbG9yX21hbnVhbCh2YWx1ZXMgPSB2aXJjb2xzKSArXG4gIHNjYWxlX3hfZGlzY3JldGUobmFtZSA9IFwiU2FtcGxlIHZpcmFsIHN0YXR1c1wiLFxuICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IGMoXCJOZWdhdGl2ZVwiLFwiUG9zaXRpdmVcIikpICtcbiAgbGFicyh5ID0gXCJEaXN0YW5jZSB0byBjZW50cm9pZFwiKSArXG4gIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9IFwibm9uZVwiKSArXG4gIGZhY2V0X3dyYXAofnNhbXBsZWxvYyxcbiAgICAgICAgICAgICBsYWJlbGxlciA9IGFzX2xhYmVsbGVyKGMoXCJzaW51c1wiID0gXCJTaW51c1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNwdXR1bVwiID0gXCJTcHV0dW1cIikpKSAtPiBjZW50cm9pZHBsb3RcblxuZ2dzYXZlKHBsb3QgPSBjZW50cm9pZHBsb3QsXG4gICAgICAgXCJhZHVsdF9jZW50cm9pZF9kaXN0YW5jZS5wZGZcIixcbiAgICAgICBoZWlnaHQgPSA4LFxuICAgICAgIHdpZHRoID0gMTIsXG4gICAgICAgdW5pdHMgPSBjKFwiaW5cIikpXG5gYGAifQ== -->

```r
allDf %>%
  dplyr::select(index,sampleloc,virus.bin,OTU,Abundance) %>%
  filter(!is.na(virus.bin)) %>%
  group_by(index) %>%
  summarise(N = sum(Abundance)) %>%
  arrange(N) %>%
  print(n = 20) # identify minimum number of reads from a sample to be included

allDf %>%
  dplyr::select(index,patientid,sampleloc,virus.bin,OTU,Abundance) %>%
  filter(!is.na(virus.bin)) %>%
  group_by(index) %>% 
  mutate(N = sum(Abundance)) %>%
  ungroup() %>%
  filter(N >= 1045) %>%
  dplyr::select(-N) %>%
  pivot_wider(names_from = \"OTU\",
              values_from = \"Abundance\",
              values_fill = 0) -> sinspuFilt

sinspuFilt %>%
  dplyr::select(index,patientid,sampleloc,virus.bin) -> sinspuFiltMeta

sinspuFilt %>%
  dplyr::select(-sampleloc,-virus.bin) %>%
  column_to_rownames(\"index\") %>%
  avgdist(sample = 1045,
          dmethod = \"horn\") -> sinspuDist

sinspuDist %>%
  hclust(method = \"ward.D2\") -> sinspuClust

wcmdscale(sinspuDist,
          eig = TRUE) -> sinspuPCoA

ordiplot(sinspuPCoA)

(sinspuPCoA$eig[1] / sum(sinspuPCoA$eig))*100 # 50.6%

(sinspuPCoA$eig[2] / sum(sinspuPCoA$eig))*100 # 26.2%

sinspuPCoA %>%
  scores() %>%
  as_tibble(rownames = \"index\") %>%
  dplyr::select(index,Dim1,Dim2) -> sinspuHornPCoA

inner_join(sinspuFiltMeta,sinspuHornPCoA) -> sinspuPCoAMeta

sinspuFiltMeta %>%
  mutate(pt_sampleloc = paste(patientid,sampleloc,sep = \"_\"),
         .before = virus.bin) -> sinspuFiltMeta

betadisper(sinspuDist,
           group = as.factor(sinspuFiltMeta$pt_sampleloc),
           type = \"centroid\") -> sinspuDFC

sinspuDFC <- as.data.frame(sinspuDFC$distances)

rownames(sinspuDFC) -> sinspuDFC$index

sinspuDFC %>%
  dplyr::rename(centroid.distance = 1) -> sinspuDFC

left_join(sinspuFiltMeta,sinspuDFC) -> sinspuDFC

summary(lmer(data = sinspuDFC,
             centroid.distance ~ virus.bin + (1|patientid)))  

ggplot(data = sinspuDFC,
       aes(x = virus.bin,
           y = centroid.distance,
           color = virus.bin)) +
  geom_boxplot() +
  geom_jitter(width = 0.1,
              size = 5,
              alpha = 0.5) +
  scale_color_manual(values = vircols) +
  scale_x_discrete(name = \"Sample viral status\",
                   labels = c(\"Negative\",\"Positive\")) +
  labs(y = \"Distance to centroid\") +
  theme(legend.position = \"none\") +
  facet_wrap(~sampleloc,
             labeller = as_labeller(c(\"sinus\" = \"Sinus\",
                                      \"sputum\" = \"Sputum\"))) -> centroidplot

ggsave(plot = centroidplot,
       \"adult_centroid_distance.pdf\",
       height = 8,
       width = 12,
       units = c(\"in\"))
```

<!-- rnb-source-end -->
<!-- KNITR_ASIS_OUTPUT_TOKEN -->"
"0","```r
allDf %>%
  dplyr::select(index,sampleloc,virus.bin,OTU,Abundance) %>%
  filter(!is.na(virus.bin)) %>%
  group_by(index) %>%
  summarise(N = sum(Abundance)) %>%
  arrange(N) %>%
  print(n = 20) # identify minimum number of reads from a sample to be included

allDf %>%
  dplyr::select(index,patientid,sampleloc,virus.bin,OTU,Abundance) %>%
  filter(!is.na(virus.bin)) %>%
  group_by(index) %>% 
  mutate(N = sum(Abundance)) %>%
  ungroup() %>%
  filter(N >= 1045) %>%
  dplyr::select(-N) %>%
  pivot_wider(names_from = \"OTU\",
              values_from = \"Abundance\",
              values_fill = 0) -> sinspuFilt

sinspuFilt %>%
  dplyr::select(index,patientid,sampleloc,virus.bin) -> sinspuFiltMeta

sinspuFilt %>%
  dplyr::select(-sampleloc,-virus.bin) %>%
  column_to_rownames(\"index\") %>%
  avgdist(sample = 1045,
          dmethod = \"horn\") -> sinspuDist

sinspuDist %>%
  hclust(method = \"ward.D2\") -> sinspuClust

wcmdscale(sinspuDist,
          eig = TRUE) -> sinspuPCoA

ordiplot(sinspuPCoA)

(sinspuPCoA$eig[1] / sum(sinspuPCoA$eig))*100 # 50.6%

(sinspuPCoA$eig[2] / sum(sinspuPCoA$eig))*100 # 26.2%

sinspuPCoA %>%
  scores() %>%
  as_tibble(rownames = \"index\") %>%
  dplyr::select(index,Dim1,Dim2) -> sinspuHornPCoA

inner_join(sinspuFiltMeta,sinspuHornPCoA) -> sinspuPCoAMeta

sinspuFiltMeta %>%
  mutate(pt_sampleloc = paste(patientid,sampleloc,sep = \"_\"),
         .before = virus.bin) -> sinspuFiltMeta

betadisper(sinspuDist,
           group = as.factor(sinspuFiltMeta$pt_sampleloc),
           type = \"centroid\") -> sinspuDFC

sinspuDFC <- as.data.frame(sinspuDFC$distances)

rownames(sinspuDFC) -> sinspuDFC$index

sinspuDFC %>%
  dplyr::rename(centroid.distance = 1) -> sinspuDFC

left_join(sinspuFiltMeta,sinspuDFC) -> sinspuDFC

summary(lmer(data = sinspuDFC,
             centroid.distance ~ virus.bin + (1|patientid)))  

ggplot(data = sinspuDFC,
       aes(x = virus.bin,
           y = centroid.distance,
           color = virus.bin)) +
  geom_boxplot() +
  geom_jitter(width = 0.1,
              size = 5,
              alpha = 0.5) +
  scale_color_manual(values = vircols) +
  scale_x_discrete(name = \"Sample viral status\",
                   labels = c(\"Negative\",\"Positive\")) +
  labs(y = \"Distance to centroid\") +
  theme(legend.position = \"none\") +
  facet_wrap(~sampleloc,
             labeller = as_labeller(c(\"sinus\" = \"Sinus\",
                                      \"sputum\" = \"Sputum\"))) -> centroidplot

ggsave(plot = centroidplot,
       \"adult_centroid_distance.pdf\",
       height = 8,
       width = 12,
       units = c(\"in\"))
```"
