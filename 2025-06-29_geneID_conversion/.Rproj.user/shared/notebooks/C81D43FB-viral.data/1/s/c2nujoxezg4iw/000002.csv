"1","<!-- KNITR_ASIS_OUTPUT_TOKEN -->
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuYWxsRGYgJT4lXG4gIGRwbHlyOjpzZWxlY3QoaW5kZXgsc2FtcGxlbG9jLHZpcnVzLmJpbixPVFUsQWJ1bmRhbmNlKSAlPiVcbiAgZmlsdGVyKCFpcy5uYSh2aXJ1cy5iaW4pKSAlPiVcbiAgZmlsdGVyKHNhbXBsZWxvYyA9PSBcInNwdXR1bVwiKSAlPiVcbiAgcGl2b3Rfd2lkZXIobmFtZXNfZnJvbSA9IFwiT1RVXCIsXG4gICAgICAgICAgICAgIHZhbHVlc19mcm9tID0gXCJBYnVuZGFuY2VcIixcbiAgICAgICAgICAgICAgdmFsdWVzX2ZpbGwgPSAwKSAtPiBzcHVcblxuc3B1ICU+JVxuICBkcGx5cjo6c2VsZWN0KGluZGV4LHNhbXBsZWxvYyx2aXJ1cy5iaW4pIC0+IHNwdU1ldGFcblxuc3B1ICU+JVxuICBkcGx5cjo6c2VsZWN0KC1zYW1wbGVsb2MsLXZpcnVzLmJpbikgJT4lXG4gIGNvbHVtbl90b19yb3duYW1lcyhcImluZGV4XCIpICU+JVxuICBhdmdkaXN0KHNhbXBsZSA9IDEwNDUsXG4gICAgICAgICAgZG1ldGhvZCA9IFwiaG9yblwiKSAtPiBzcHVEaXN0XG5cbndjbWRzY2FsZShzcHVEaXN0LFxuICAgICAgICAgIGVpZyA9IFRSVUUpIC0+IHNwdVBDb0Fcblxub3JkaXBsb3Qoc3B1UENvQSlcblxuKHNwdVBDb0EkZWlnWzFdIC8gc3VtKHNwdVBDb0EkZWlnKSkqMTAwICMgdmFyaWFuY2UgZXhwbGFpbmVkIGJ5IHZlY3RvciAxID0gNTcuNyVcblxuKHNwdVBDb0EkZWlnWzJdIC8gc3VtKHNwdVBDb0EkZWlnKSkqMTAwICMgdmFyaWFuY2UgZXhwbGFpbmVkIGJ5IHZlY3RvciAyID0gMjEuNCVcblxuc3B1UENvQSAlPiVcbiAgc2NvcmVzKCkgJT4lXG4gIGFzX3RpYmJsZShyb3duYW1lcyA9IFwiaW5kZXhcIikgJT4lXG4gIGRwbHlyOjpzZWxlY3QoaW5kZXgsRGltMSxEaW0yKSAtPiBzcHVIb3JuUENvQVxuXG5pbm5lcl9qb2luKHNwdU1ldGEsc3B1SG9yblBDb0EpIC0+IHNwdVBDb0FNZXRhXG5cbnNwdVBDb0FNZXRhICU+JVxuICBncm91cF9ieSh2aXJ1cy5iaW4pICU+JVxuICBtdXRhdGUobWVhbi5kaW0xID0gbWVhbihEaW0xKSkgJT4lXG4gIG11dGF0ZShtZWFuLmRpbTIgPSBtZWFuKERpbTIpKSAlPiVcbiAgZHBseXI6OnNlbGVjdCh2aXJ1cy5iaW4sbWVhbi5kaW0xLG1lYW4uZGltMikgJT4lXG4gIGRpc3RpbmN0KCkgLT4gc3B1RGltTWVhbnNcblxuXG5nZ3Bsb3QoZGF0YSA9IHNwdVBDb0FNZXRhLFxuICAgICAgIGFlcyh4ID0gRGltMSxcbiAgICAgICAgICAgeSA9IERpbTIsXG4gICAgICAgICAgIGNvbG9yID0gdmlydXMuYmluKSkgK1xuICBnZW9tX3BvaW50KGRhdGEgPSBzcHVEaW1NZWFucyxcbiAgICAgICAgICAgICBhZXMoeCA9IG1lYW4uZGltMSxcbiAgICAgICAgICAgICAgICAgeSA9IG1lYW4uZGltMixcbiAgICAgICAgICAgICAgICAgY29sb3IgPSB2aXJ1cy5iaW4pLFxuICAgICAgICAgICAgIHNpemUgPSA1KSArXG4gIGdlb21fcG9pbnQoKSArXG4gIHNjYWxlX2NvbG9yX21hbnVhbChuYW1lID0gXCJTYW1wbGUgdmlyYWwgc3RhdHVzXCIsXG4gICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSBjKFwicHVycGxlNFwiLFwib3JhbmdlXCIpLFxuICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gYyhcIk5lZ2F0aXZlXCIsXCJQb3NpdGl2ZVwiKSkgK1xuICBzdGF0X2VsbGlwc2UodHlwZSA9IFwidFwiKSArXG4gIGxhYnMoeCA9IFwiUENvQSAxICg1Ny43JSlcIixcbiAgICAgICB5ID0gXCJQQ29BIDIgKDIxLjQlKVwiKSAtPiBzcHV0dW1QQ29BXG5cbnNwdXR1bVBDb0FcblxuZ2dzYXZlKHBsb3QgPSBzcHV0dW1QQ29BLFxuICAgICAgIFwic3B1dHVtLlBDb0EubW9yaXNpdGEtaG9ybi5wZGZcIixcbiAgICAgICBoZWlnaHQgPSAxMixcbiAgICAgICB3aWR0aCA9IDgsXG4gICAgICAgdW5pdHMgPSBjKFwiaW5cIikpXG5gYGAifQ== -->

```r
allDf %>%
  dplyr::select(index,sampleloc,virus.bin,OTU,Abundance) %>%
  filter(!is.na(virus.bin)) %>%
  filter(sampleloc == \"sputum\") %>%
  pivot_wider(names_from = \"OTU\",
              values_from = \"Abundance\",
              values_fill = 0) -> spu

spu %>%
  dplyr::select(index,sampleloc,virus.bin) -> spuMeta

spu %>%
  dplyr::select(-sampleloc,-virus.bin) %>%
  column_to_rownames(\"index\") %>%
  avgdist(sample = 1045,
          dmethod = \"horn\") -> spuDist

wcmdscale(spuDist,
          eig = TRUE) -> spuPCoA

ordiplot(spuPCoA)

(spuPCoA$eig[1] / sum(spuPCoA$eig))*100 # variance explained by vector 1 = 57.7%

(spuPCoA$eig[2] / sum(spuPCoA$eig))*100 # variance explained by vector 2 = 21.4%

spuPCoA %>%
  scores() %>%
  as_tibble(rownames = \"index\") %>%
  dplyr::select(index,Dim1,Dim2) -> spuHornPCoA

inner_join(spuMeta,spuHornPCoA) -> spuPCoAMeta

spuPCoAMeta %>%
  group_by(virus.bin) %>%
  mutate(mean.dim1 = mean(Dim1)) %>%
  mutate(mean.dim2 = mean(Dim2)) %>%
  dplyr::select(virus.bin,mean.dim1,mean.dim2) %>%
  distinct() -> spuDimMeans


ggplot(data = spuPCoAMeta,
       aes(x = Dim1,
           y = Dim2,
           color = virus.bin)) +
  geom_point(data = spuDimMeans,
             aes(x = mean.dim1,
                 y = mean.dim2,
                 color = virus.bin),
             size = 5) +
  geom_point() +
  scale_color_manual(name = \"Sample viral status\",
                     values = c(\"purple4\",\"orange\"),
                     labels = c(\"Negative\",\"Positive\")) +
  stat_ellipse(type = \"t\") +
  labs(x = \"PCoA 1 (57.7%)\",
       y = \"PCoA 2 (21.4%)\") -> sputumPCoA

sputumPCoA

ggsave(plot = sputumPCoA,
       \"sputum.PCoA.morisita-horn.pdf\",
       height = 12,
       width = 8,
       units = c(\"in\"))
```

<!-- rnb-source-end -->
<!-- KNITR_ASIS_OUTPUT_TOKEN -->"
"0","```r
allDf %>%
  dplyr::select(index,sampleloc,virus.bin,OTU,Abundance) %>%
  filter(!is.na(virus.bin)) %>%
  filter(sampleloc == \"sputum\") %>%
  pivot_wider(names_from = \"OTU\",
              values_from = \"Abundance\",
              values_fill = 0) -> spu

spu %>%
  dplyr::select(index,sampleloc,virus.bin) -> spuMeta

spu %>%
  dplyr::select(-sampleloc,-virus.bin) %>%
  column_to_rownames(\"index\") %>%
  avgdist(sample = 1045,
          dmethod = \"horn\") -> spuDist

wcmdscale(spuDist,
          eig = TRUE) -> spuPCoA

ordiplot(spuPCoA)

(spuPCoA$eig[1] / sum(spuPCoA$eig))*100 # variance explained by vector 1 = 57.7%

(spuPCoA$eig[2] / sum(spuPCoA$eig))*100 # variance explained by vector 2 = 21.4%

spuPCoA %>%
  scores() %>%
  as_tibble(rownames = \"index\") %>%
  dplyr::select(index,Dim1,Dim2) -> spuHornPCoA

inner_join(spuMeta,spuHornPCoA) -> spuPCoAMeta

spuPCoAMeta %>%
  group_by(virus.bin) %>%
  mutate(mean.dim1 = mean(Dim1)) %>%
  mutate(mean.dim2 = mean(Dim2)) %>%
  dplyr::select(virus.bin,mean.dim1,mean.dim2) %>%
  distinct() -> spuDimMeans


ggplot(data = spuPCoAMeta,
       aes(x = Dim1,
           y = Dim2,
           color = virus.bin)) +
  geom_point(data = spuDimMeans,
             aes(x = mean.dim1,
                 y = mean.dim2,
                 color = virus.bin),
             size = 5) +
  geom_point() +
  scale_color_manual(name = \"Sample viral status\",
                     values = c(\"purple4\",\"orange\"),
                     labels = c(\"Negative\",\"Positive\")) +
  stat_ellipse(type = \"t\") +
  labs(x = \"PCoA 1 (57.7%)\",
       y = \"PCoA 2 (21.4%)\") -> sputumPCoA

sputumPCoA

ggsave(plot = sputumPCoA,
       \"sputum.PCoA.morisita-horn.pdf\",
       height = 12,
       width = 8,
       units = c(\"in\"))
```"
