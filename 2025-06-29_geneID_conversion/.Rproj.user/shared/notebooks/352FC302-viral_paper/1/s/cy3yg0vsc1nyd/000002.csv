"1","<!-- KNITR_ASIS_OUTPUT_TOKEN -->
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuYWxsRGYgJT4lXG4gIGZpbHRlcihpbmRleCAlaW4lIHNpbnNwdSkgJT4lXG4gIGZpbHRlcihzYW1wbGVsb2MgPT0gXCJzaW51c1wiKSAlPiVcbiAgZHBseXI6OnNlbGVjdChwYXRpZW50aWQsZGF0ZSxpbmRleCx2aXJ1cy5iaW4pICU+JVxuICBkaXN0aW5jdCgpICU+JVxuICBsZWZ0X2pvaW4oLixjeXRva2luZSkgJT4lXG4gIHBpdm90X2xvbmdlcihjb2xzID0gYyg1OjQxKSxcbiAgICAgICAgICAgICAgIG5hbWVzX3RvID0gXCJjeXRva2luZVwiLFxuICAgICAgICAgICAgICAgdmFsdWVzX3RvID0gXCJ2YWx1ZVwiKSAtPiBjeXRvVmlydXNcblxuY3l0b0ludCA8LSBjKFwiQVBSSUxcIixcIkNoaXRpbmFzZTNsaWtlMVwiLFwiSUZOYTJcIixcIklMMTBcIilcblxucGxvdF9jeXRva2luZSA8LSBmdW5jdGlvbihkZixjeXRva2luZSl7XG4gIHBkZihwYXN0ZShcImN5dG9raW5lc1wiLFxuICAgICAgICAgICAgcGFzdGUoeCxcIi5wZGZcIixcbiAgICAgICAgICAgICAgICAgIHNlcCA9IFwiXCIpLFxuICAgICAgICAgICAgc2VwID0gXCIvXCIpLFxuICAgICAgcGFwZXIgPSBcImE0XCIpXG4gICAgXG4gICAgcHJpbnQoZGYgJT4lXG4gICAgICAgICAgICBmaWx0ZXIoY3l0b2tpbmUgPT0geCkgJT4lXG4gICAgICAgICAgICBnZ3Bsb3QoYWVzKHggPSB2aXJ1cy5iaW4sXG4gICAgICAgICAgICAgICAgICAgICAgIHkgPSB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSB2aXJ1cy5iaW4pKSArXG4gICAgICAgICAgICBnZW9tX2JveHBsb3QoKSlcbiAgICBcbiAgICBkZXYub2ZmKClcbiAgICB9XG59XG5cbmZvcih4IGluIGN5dG9JbnQpe1xuICBwbG90X2N5dG9raW5lKGN5dG9WaXJ1cyx4KVxufVxuXG5hbGxEZiAlPiVcbiAgZmlsdGVyKGluZGV4ICVpbiUgc2luc3B1KSAlPiVcbiAgZmlsdGVyKHNhbXBsZWxvYyA9PSBcInNpbnVzXCIpICU+JVxuICBncm91cF9ieShpbmRleCkgJT4lXG4gIHNsaWNlX21heChyZWxfYWIpICU+JVxuICB1bmdyb3VwKCkgJT4lXG4gIGRwbHlyOjpzZWxlY3QoZ2VudXMpICU+JVxuICBkaXN0aW5jdCgpICU+JVxuICAuJGdlbnVzIC0+IHNpbnVzX21vc3RfYWJcblxuYWxsRGYgJT4lXG4gIGZpbHRlcihpbmRleCAlaW4lIHNpbnNwdSkgJT4lXG4gIGZpbHRlcihzYW1wbGVsb2MgPT0gXCJzaW51c1wiKSAlPiVcbiAgZmlsdGVyKGdlbnVzID09IFwiUHNldWRvbW9uYXNcIikgJT4lXG4gIGRwbHlyOjpzZWxlY3QoaW5kZXgscmVsX2FiKSAlPiVcbiAgZGlzdGluY3QoKSAlPiVcbiAgbGVmdF9qb2luKC4sY3l0b1ZpcnVzKSAlPiVcbiAgcGl2b3Rfd2lkZXIobmFtZXNfZnJvbSA9IGN5dG9raW5lLFxuICAgICAgICAgICAgICB2YWx1ZXNfZnJvbSA9IHZhbHVlKSAlPiVcbiAgbGVmdF9qb2luKC4sZW5yb2xsbWVudF9kYXRhKSAlPiVcbiAgZHBseXI6OnNlbGVjdChhbGxfb2YoYyhcImluZGV4XCIsdW5pcXVlKGN5dG9WaXJ1cyRjeXRva2luZSksXCJhZ2VcIixcImFsbGVyZ2ljX3JoaW5pdGlzXCIsXCJyZWxfYWJcIikpKSAlPiVcbiAgY29sdW1uX3RvX3Jvd25hbWVzKFwiaW5kZXhcIikgLT4gY29yTWF0XG5cbmNvck1hdFtbXCJjdFwiXV1baXMubmEoY29yTWF0W1tcImN0XCJdXSldIDwtIDUwXG5cbmNvck1hdFtpcy5uYShjb3JNYXQpXSA8LSAwXG5cbmNvci5tdGVzdChjb3JNYXQsY29uZi5sZXZlbCA9IDAuOTUpIC0+IGNvclB2YWx1ZVxuXG5kYXRhLmZyYW1lKGNvclB2YWx1ZSRwKSAtPiBjb3JyUHZhbHVlRGZcblxuY29yclB2YWx1ZURmICU+JVxuICBkcGx5cjo6c2VsZWN0KGFnZSkgJT4lXG4gIGZpbHRlcihhZ2UgPCAwLjA1KSAtPiBjb3JzaWdhZ2VcblxuY29yclB2YWx1ZURmICU+JVxuICBkcGx5cjo6c2VsZWN0KGFnZSkgJT4lXG4gIGZpbHRlcihhZ2UgPCAwLjA1KSAtPiBjb3JzaWdhZ2VcblxuY29yclB2YWx1ZURmICU+JVxuICBkcGx5cjo6c2VsZWN0KGFsbGVyZ2ljX3JoaW5pdGlzKSAlPiVcbiAgZmlsdGVyKGFsbGVyZ2ljX3JoaW5pdGlzIDwgMC4wNSkgLT4gY29yc2lnQVJcblxucm93bmFtZXMoY29yc2lnYWdlKSAtPiBjb3JzaWdhZ2VcblxuY29yc2lnYWdlWzE6OF0gLT4gY29yc2lnYWdlXG5cbnJvd25hbWVzKGNvcnNpZ0FSKSAtPiBjb3JzaWdBUlxuXG5jb3JzaWdBUlsxOjEwXSAtPiBjb3JzaWdBUlxuXG5jb3IoY29yTWF0KSAtPiBjb3JEZlxuXG5wZGYoXCJjb3JyX3Bsb3RfY3l0b2tpbmVzX3JlbF9hYnVuZGFuY2UucGRmXCIsXG4gICAgaGVpZ2h0ID0gMTAsXG4gICAgd2lkdGggPSAxMClcblxuY29ycnBsb3QoY29yRGYsXG4gICAgICAgICB0eXBlID0gXCJsb3dlclwiLFxuICAgICAgICAgbWV0aG9kID0gXCJzaGFkZVwiLFxuICAgICAgICAgZGlhZyA9IEZBTFNFLFxuICAgICAgICAgcC5tYXQgPSBjb3JQdmFsdWUkcCxcbiAgICAgICAgIHNpZy5sZXZlbCA9IGMoMC4wMDEsIDAuMDEsIDAuMDUpLFxuICAgICAgICAgcGNoLmNvbCA9IFwiYmxhY2tcIixcbiAgICAgICAgIHRsLmNvbCA9IFwiYmxhY2tcIixcbiAgICAgICAgIGluc2lnID0gXCJsYWJlbF9zaWdcIixcbiAgICAgICAgIHBjaC5jZXggPSAwLjgpXG5cbmRldi5vZmYoKVxuYGBgIn0= -->

```r
allDf %>%
  filter(index %in% sinspu) %>%
  filter(sampleloc == \"sinus\") %>%
  dplyr::select(patientid,date,index,virus.bin) %>%
  distinct() %>%
  left_join(.,cytokine) %>%
  pivot_longer(cols = c(5:41),
               names_to = \"cytokine\",
               values_to = \"value\") -> cytoVirus

cytoInt <- c(\"APRIL\",\"Chitinase3like1\",\"IFNa2\",\"IL10\")

plot_cytokine <- function(df,cytokine){
  pdf(paste(\"cytokines\",
            paste(x,\".pdf\",
                  sep = \"\"),
            sep = \"/\"),
      paper = \"a4\")
    
    print(df %>%
            filter(cytokine == x) %>%
            ggplot(aes(x = virus.bin,
                       y = value,
                       color = virus.bin)) +
            geom_boxplot())
    
    dev.off()
    }
}

for(x in cytoInt){
  plot_cytokine(cytoVirus,x)
}

allDf %>%
  filter(index %in% sinspu) %>%
  filter(sampleloc == \"sinus\") %>%
  group_by(index) %>%
  slice_max(rel_ab) %>%
  ungroup() %>%
  dplyr::select(genus) %>%
  distinct() %>%
  .$genus -> sinus_most_ab

allDf %>%
  filter(index %in% sinspu) %>%
  filter(sampleloc == \"sinus\") %>%
  filter(genus == \"Pseudomonas\") %>%
  dplyr::select(index,rel_ab) %>%
  distinct() %>%
  left_join(.,cytoVirus) %>%
  pivot_wider(names_from = cytokine,
              values_from = value) %>%
  left_join(.,enrollment_data) %>%
  dplyr::select(all_of(c(\"index\",unique(cytoVirus$cytokine),\"age\",\"allergic_rhinitis\",\"rel_ab\"))) %>%
  column_to_rownames(\"index\") -> corMat

corMat[[\"ct\"]][is.na(corMat[[\"ct\"]])] <- 50

corMat[is.na(corMat)] <- 0

cor.mtest(corMat,conf.level = 0.95) -> corPvalue

data.frame(corPvalue$p) -> corrPvalueDf

corrPvalueDf %>%
  dplyr::select(age) %>%
  filter(age < 0.05) -> corsigage

corrPvalueDf %>%
  dplyr::select(age) %>%
  filter(age < 0.05) -> corsigage

corrPvalueDf %>%
  dplyr::select(allergic_rhinitis) %>%
  filter(allergic_rhinitis < 0.05) -> corsigAR

rownames(corsigage) -> corsigage

corsigage[1:8] -> corsigage

rownames(corsigAR) -> corsigAR

corsigAR[1:10] -> corsigAR

cor(corMat) -> corDf

pdf(\"corr_plot_cytokines_rel_abundance.pdf\",
    height = 10,
    width = 10)

corrplot(corDf,
         type = \"lower\",
         method = \"shade\",
         diag = FALSE,
         p.mat = corPvalue$p,
         sig.level = c(0.001, 0.01, 0.05),
         pch.col = \"black\",
         tl.col = \"black\",
         insig = \"label_sig\",
         pch.cex = 0.8)

dev.off()
```

<!-- rnb-source-end -->
<!-- KNITR_ASIS_OUTPUT_TOKEN -->"
"0","```r
allDf %>%
  filter(index %in% sinspu) %>%
  filter(sampleloc == \"sinus\") %>%
  dplyr::select(patientid,date,index,virus.bin) %>%
  distinct() %>%
  left_join(.,cytokine) %>%
  pivot_longer(cols = c(5:41),
               names_to = \"cytokine\",
               values_to = \"value\") -> cytoVirus

cytoInt <- c(\"APRIL\",\"Chitinase3like1\",\"IFNa2\",\"IL10\")

plot_cytokine <- function(df,cytokine){
  pdf(paste(\"cytokines\",
            paste(x,\".pdf\",
                  sep = \"\"),
            sep = \"/\"),
      paper = \"a4\")
    
    print(df %>%
            filter(cytokine == x) %>%
            ggplot(aes(x = virus.bin,
                       y = value,
                       color = virus.bin)) +
            geom_boxplot())
    
    dev.off()
    }
}

for(x in cytoInt){
  plot_cytokine(cytoVirus,x)
}

allDf %>%
  filter(index %in% sinspu) %>%
  filter(sampleloc == \"sinus\") %>%
  group_by(index) %>%
  slice_max(rel_ab) %>%
  ungroup() %>%
  dplyr::select(genus) %>%
  distinct() %>%
  .$genus -> sinus_most_ab

allDf %>%
  filter(index %in% sinspu) %>%
  filter(sampleloc == \"sinus\") %>%
  filter(genus == \"Pseudomonas\") %>%
  dplyr::select(index,rel_ab) %>%
  distinct() %>%
  left_join(.,cytoVirus) %>%
  pivot_wider(names_from = cytokine,
              values_from = value) %>%
  left_join(.,enrollment_data) %>%
  dplyr::select(all_of(c(\"index\",unique(cytoVirus$cytokine),\"age\",\"allergic_rhinitis\",\"rel_ab\"))) %>%
  column_to_rownames(\"index\") -> corMat

corMat[[\"ct\"]][is.na(corMat[[\"ct\"]])] <- 50

corMat[is.na(corMat)] <- 0

cor.mtest(corMat,conf.level = 0.95) -> corPvalue

data.frame(corPvalue$p) -> corrPvalueDf

corrPvalueDf %>%
  dplyr::select(age) %>%
  filter(age < 0.05) -> corsigage

corrPvalueDf %>%
  dplyr::select(age) %>%
  filter(age < 0.05) -> corsigage

corrPvalueDf %>%
  dplyr::select(allergic_rhinitis) %>%
  filter(allergic_rhinitis < 0.05) -> corsigAR

rownames(corsigage) -> corsigage

corsigage[1:8] -> corsigage

rownames(corsigAR) -> corsigAR

corsigAR[1:10] -> corsigAR

cor(corMat) -> corDf

pdf(\"corr_plot_cytokines_rel_abundance.pdf\",
    height = 10,
    width = 10)

corrplot(corDf,
         type = \"lower\",
         method = \"shade\",
         diag = FALSE,
         p.mat = corPvalue$p,
         sig.level = c(0.001, 0.01, 0.05),
         pch.col = \"black\",
         tl.col = \"black\",
         insig = \"label_sig\",
         pch.cex = 0.8)

dev.off()
```"
