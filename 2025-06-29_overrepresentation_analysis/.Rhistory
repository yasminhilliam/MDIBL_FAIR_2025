Messymt # this is a Contingency table
Messymt <- matrix(c(299,208,178,315), nrow = 2, dimnames = list(
Messy=c("Yes", "No"),
Gender = c("Men", "Women")
))
Messymt # this is a Contingency table
Messymt <- matrix(c(299,208,178,315),
nrow = 2,
dimnames = list(
Messy = c("Yes", "No"),
Gender = c("Men", "Women")
))
Messymt # this is a Contingency table
fisher.test(Messymt,
alternative = "two.sided")$p.value
fisher.test(Messymt,
alternative = "greater")$p.value
fisher.test(Messymt,
alternative = "two.sided")$p.value
?fisher.test
fisher.test(Messymt,
alternative = "less")$p.value
fisher.test(Messymt,
alternative = "two.sided")
fisher.test(Messymt,
alternative = "two.sided")$p.value
fisher.test(Messymt)
fisher.test(Messymt,
alternative = "greater")
fisher.test(Messymt,
alternative = "less")
read.table(file = "overRepresentation_GSEAactivation_FAIR2024/InnateImmune.txt") -> innate
View(innate)
innate$V1 -> innate
length(innate)
innate$V1 -> innate
read.table(file = "overRepresentation_GSEAactivation_FAIR2024/InnateImmune.txt") -> innate
innate$V1 -> innate_vec
length(innate_vec)
innate$V1 -> innate_vec
head(innate_vec)
length(innate_vec) # there are 561 genes in this list
View(lrt)
load("edgeR2024_lrt_object.Rdata")
library(edgeR)
library(gplots)
Messymt <- matrix(c(299,208,178,315),
nrow = 2,
dimnames = list(
Messy = c("Yes", "No"),
Gender = c("Men", "Women")
))
Messymt # this is a Contingency table
fisher.test(Messymt,
alternative = "two.sided")
fisher.test(Messymt,
alternative = "greater")
fisher.test(Messymt,
alternative = "less")
read.table(file = "InnateImmune.txt") -> innate
innate$V1 -> innate_vec
head(innate_vec)
length(innate_vec) # there are 561 genes in this list
read.csv("log2FC_PA_vs_Untreated.csv") -> edgeR_data
head(edgeR_data)
read.csv("log2FC_PA_vs_Untreated.csv") -> edgeR_data
head(edgeR_data)
library(edgeR)
library(gplots)
library(tidyverse)
View(edgeR_data)
edgeR_data %>%
filter(logFC > 0 & FDR < 0.05)
edgeR_data %>%
filter(logFC > 0 & FDR < 0.05) -> up_DEGs
edgeR_data %>%
filter(logFC > 0 & FDR < 0.05) -> up_DEGs
length(up_DEGs)
head(up_DEGs)
length(up_DEGs)
View(up_DEGs)
edgeR_data %>%
filter(logFC > 0 & FDR < 0.05) -> up_DEGs
dim(up_DEGs)
head(up_DEGs)
up_DEGs$ENSEMBL -> up_DEGs_vec
edgeR_data %>%
filter(logFC > 0 & FDR < 0.05) -> up_DEGs
dim(up_DEGs)
head(up_DEGs)
edgeR_data$ENSEMBL -> all_genes_vec
length(all_genes_vec)
edgeR_data$ENSEMBL -> all_genes_vec
length(all_genes_vec)
venn(list("Upregulated genes" = up_DEGs_vec,
"Innate immune genes" = innate_vec,
"Expressed genes" = all_genes_vec))
?setdiff
setdiff(all_genes_vec,up_DEGs)
setdiff()
up_DEGs_vec -> Upregulated
setdiff(all_genes_vec,Upregulated) -> NotRegulated
intersect(all_genes_vec,innate_vec) -> OnPath
setdiff(all_genes_vec,OnPath) -> NotOnPath
values <- c(length(intersect(OnPath,Upregulated)), # get number of upregulated immune genes
length(intersect(OnPath,NotRegulated)), # unregulated immune genes
length(intersect(NotOnPath,Upregulated)), # upregulated non immune genes
length(intersect(NotOnPath,NotRegulated))) # unregulated non immune genes
matrix(values, nrow = 2,
dimnames = list(
Upregulated = c("Yes","No"),
OnPath = c("Yes","No")
)) -> innate_immune_path_matrix
innate_immune_path_matrix
matrix(values, nrow = 2,
dimnames = list(
Upregulated = c("Yes","No"),
OnPath = c("Yes","No")
)) -> innate_immune_path_matrix
innate_immune_path_matrix
fisher.test(innate_immune_path_matrix,
alternative = "greater")
?setdiff
matrix(values, nrow = 2,
dimnames = list(
Upregulated = c("Yes","No"),
OnPath = c("Yes","No")
)) -> innate_immune_path_matrix
innate_immune_path_matrix
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
install.packages("GO.db")
library(GO.db)
library(org.Hs.eg.db)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("GO.db")
library(GO.db)
library(org.Hs.eg.db)
lrt$genes
read.csv("AnnotTable.csv")
read.csv("AnnotTable.csv") -> annot
lrt %>%
left_join(.,annot)
lrt$genes
left_join(lrt$genes,annot)
annot
genes
lrt$genes
?left_join
left_join(lrt$genes,annot,
join_by(genes == ENSEMBL))
read.csv("AnnotTable.csv") -> annot
left_join(lrt$genes,annot,
join_by(genes == ENSEMBL)) -> annot
library(goana)
BiocManager::install("goana")
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.05) -> goana_res
View(lrt)
left_join(lrt$genes,annot,
join_by(genes == ENSEMBL)) -> lrt$genes
read.csv("AnnotTable.csv") -> annot
left_join(lrt$genes,annot,
join_by(genes == ENSEMBL)) -> lrt$genes
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.05) -> goana_res
head(goana_res)
str(goana_res)
dim(goana_res)
p.adjust(goana_res$P.Up,
method = "fdr") -> goana_res$P.Up.adj
p.adjust(goana_res$P.Down,
method = "fdr") -> goana_res$P.Down.adj
View(goana_res)
head(goana_res)
p.adjust(goana_res$P.Up,
method = "fdr") -> goana_res$P.Up.adj
p.adjust(goana_res$P.Down,
method = "fdr") -> goana_res$P.Down.adj
head(goana_res)
dim(goana_res %>%
filter(P.Up.adj < 0.05 & Ont == "BP"))
dim(goana_res %>%
filter(P.Down.adj < 0.05 & Ont == "BP"))
View(goana_res)
range(goana_res$P.Down.adj)
View(lrt)
View(annot)
dim(goana_res %>%
filter(P.Up < 0.05 & Ont == "BP")) # 1321
dim(goana_res %>%
filter(P.Up < 0.05 & Ont == "BP")) # 1321
dim(goana_res %>%
filter(P.UP.adj < 0.05 & Ont == "BP"))
dim(goana_res %>%
filter(P.Up < 0.05 & Ont == "BP")) # 1321
dim(goana_res %>%
filter(P.Up.adj < 0.05 & Ont == "BP"))
dim(goana_res %>%
filter(P.Up.adj))
dim(goana_res %>%
filter(P.Up.adj < 0.05))
topGO(goana_res)
?topGO
hist(goana_res$N)
hist(goana_res$N[goana_res$N < 1000])
hist(goana_res$N[goana_res$N < 200])
hist(goana_res$N[goana_res$N < 200])
goana_res %>%
filter(Ont == "BP" & N < 200 & P.Up.adj < 0.05)
goana_res %>%
filter(Ont == "BP" & N < 200 & P.Up.adj < 0.05) -> goana_res_filt
goana_res_filt %>%
arrange(P.Up.adj)
?arrange
goana_res_filt %>%
arrange( # arrange sorts dataframe by specified column variable
P.Up.adj
) %>%
slice_max(n = 10)
goana_res_filt %>%
slice_min(n = 10,
order_by = P.Up.adj)
goana_res %>%
filter(P.Up.adj < 0.05 & P.Up.adj > 0.049)
View(goana_res)
goana_res %>%
filter(row.names(goana_res) == "GO:0050868")
View(goana_res)
rownames(goana_res)
View(goana_res_filt)
goana_res %>%
filter(row.names(goana_res) %in% c("GO:0009062","GO:0046349","GO:0010803"))
goana_res %>%
filter(P.Down.adj < 0.05)
goana_res %>%
filter(P.Up.adj < 0.07 & > P.Up.adj > 0.05)
goana_res %>%
filter(P.Up.adj < 0.07 & P.Up.adj > 0.05)
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.1)
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.001)
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.0001)
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.1) -> goana_res_1
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.0001) -> goana_res_0001
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.1) -> goana_res_1
p.adjust(goana_res_1$P.Up,
method = "fdr") -> goana_res_1$P.Up.adj
p.adjust(goana_res_1$P.Down,
method = "fdr") -> goana_res_1$P.Down.adj
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.0001) -> goana_res_0001
p.adjust(goana_res_0001$P.Up,
method = "fdr") -> goana_res_0001$P.Up.adj
p.adjust(goana_res_0001$P.Down,
method = "fdr") -> goana_res_0001$P.Down.adj
goana_res_1 %>%
filter(P.Up.adj < 0.1)
goana_res_0001 %>%
filter(P.Up.adj < 0.0001)
?kegga
kegga(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.05)
kegga(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.05) -> kegga_res
p.adjust(kegga_res$P.Up,
method = "fdr") -> kegga_res$P.Up.adj
p.adjust(kegga_res$P.Down,
method = "fdr") -> kegga_res$P.Down.adj
dim(kegga_res)
kegga_res %>%
slice_min(n = 10,
order_by = P.Up.adj)
kegga_res %>%
slice_min(n = 10,
order_by = P.Down.adj)
load("edgeR2024_lrt_object.Rdata")
library(edgeR)
library(gplots)
library(tidyverse)
Messymt <- matrix(c(299,208,178,315),
nrow = 2,
dimnames = list(
Messy = c("Yes", "No"),
Gender = c("Men", "Women")
))
Messymt # this is a Contingency table
fisher.test(Messymt,
alternative = "two.sided")
fisher.test(Messymt,
alternative = "greater")
fisher.test(Messymt,
alternative = "less")
read.table(file = "InnateImmune.txt") -> innate
innate$V1 -> innate_vec
head(innate_vec)
length(innate_vec) # there are 561 genes in this list
read.csv("log2FC_PA_vs_Untreated.csv") -> edgeR_data
head(edgeR_data)
edgeR_data %>%
filter(logFC > 0 & FDR < 0.05) -> up_DEGs
dim(up_DEGs) # 1032 upregulated genes
head(up_DEGs)
up_DEGs$ENSEMBL -> up_DEGs_vec
edgeR_data$ENSEMBL -> all_genes_vec
length(all_genes_vec)
venn(list("Upregulated genes" = up_DEGs_vec,
"Innate immune genes" = innate_vec,
"Expressed genes" = all_genes_vec))
up_DEGs_vec -> Upregulated
setdiff( # extracts a vector of non-shared values
all_genes_vec,Upregulated
) -> NotRegulated
intersect( # extracts a vector of shared values
all_genes_vec,innate_vec
) -> OnPath
setdiff(all_genes_vec,OnPath) -> NotOnPath
values <- c(length(intersect(OnPath,Upregulated)), # get number of upregulated immune genes
length(intersect(OnPath,NotRegulated)), # unregulated immune genes
length(intersect(NotOnPath,Upregulated)), # upregulated non immune genes
length(intersect(NotOnPath,NotRegulated))) # unregulated non immune genes
matrix(values, nrow = 2,
dimnames = list(
Upregulated = c("Yes","No"),
OnPath = c("Yes","No")
)) -> innate_immune_path_matrix
innate_immune_path_matrix
fisher.test(innate_immune_path_matrix,
alternative = "greater")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("GO.db","goana"))
library(GO.db)
library(org.Hs.eg.db)
lrt$genes
read.csv("AnnotTable.csv") -> annot
left_join(lrt$genes,annot,
join_by(genes == ENSEMBL)) -> lrt$genes
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.05) -> goana_res
str(goana_res)
head(goana_res)
dim(goana_res)
p.adjust(goana_res$P.Up,
method = "fdr") -> goana_res$P.Up.adj
p.adjust(goana_res$P.Down,
method = "fdr") -> goana_res$P.Down.adj
head(goana_res)
dim(goana_res %>%
filter(P.Up < 0.05 & Ont == "BP")) # 2547
dim(goana_res %>%
filter(P.Up.adj < 0.05 & Ont == "BP")) # 1321
dim(goana_res %>%
filter(P.Up.adj < 0.05)) # 1523
topGO(goana_res)
hist(goana_res$N) # column N shows the number of genes in a GO term
hist(goana_res$N[goana_res$N < 1000])
hist(goana_res$N[goana_res$N < 200])
goana_res %>%
filter(Ont == "BP" & N < 200 & P.Up.adj < 0.05) -> goana_res_filt
goana_res_filt %>%
slice_min( # "slices" N number of rows with minimum values based on a variable
n = 10, # number of rows to slice
order_by = P.Up.adj # variable to order by
)
goana_res %>%
filter(P.Up.adj < 0.05 & P.Up.adj > 0.049)
goana_res %>%
filter(row.names(goana_res) == "GO:0050868")
goana_res %>%
filter(row.names(goana_res) %in% c("GO:0009062","GO:0046349","GO:0010803"))
goana_res %>%
filter(P.Down.adj < 0.05)
load("edgeR2024_lrt_object.Rdata")
library(edgeR)
library(gplots)
library(tidyverse)
Messymt <- matrix(c(299,208,178,315),
nrow = 2,
dimnames = list(
Messy = c("Yes", "No"),
Gender = c("Men", "Women")
))
Messymt # this is a Contingency table
fisher.test(Messymt,
alternative = "two.sided")
fisher.test(Messymt,
alternative = "greater")
fisher.test(Messymt,
alternative = "less")
read.table(file = "InnateImmune.txt") -> innate
View(innate)
innate$V1 -> innate_vec
head(innate_vec)
length(innate_vec) # there are 561 genes in this list
read.csv("log2FC_PA_vs_Untreated.csv") -> edgeR_data
head(edgeR_data)
edgeR_data %>%
filter(logFC > 0 & FDR < 0.05) -> up_DEGs
dim(up_DEGs) # 1032 upregulated genes
head(up_DEGs)
up_DEGs$ENSEMBL -> up_DEGs_vec
edgeR_data$ENSEMBL -> all_genes_vec
length(all_genes_vec)
venn(list("Upregulated genes" = up_DEGs_vec,
"Innate immune genes" = innate_vec,
"Expressed genes" = all_genes_vec))
up_DEGs_vec -> Upregulated
setdiff( # extracts a vector of non-shared values
all_genes_vec,Upregulated
) -> NotRegulated
intersect( # extracts a vector of shared values
all_genes_vec,innate_vec
) -> OnPath
setdiff(all_genes_vec,OnPath) -> NotOnPath
values <- c(length(intersect(OnPath,Upregulated)), # get number of upregulated immune genes
length(intersect(OnPath,NotRegulated)), # unregulated immune genes
length(intersect(NotOnPath,Upregulated)), # upregulated non immune genes
length(intersect(NotOnPath,NotRegulated))) # unregulated non immune genes
matrix(values, nrow = 2,
dimnames = list(
Upregulated = c("Yes","No"),
OnPath = c("Yes","No")
)) -> innate_immune_path_matrix
innate_immune_path_matrix
fisher.test(innate_immune_path_matrix,
alternative = "greater")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("GO.db","goana"))
library(GO.db)
library(org.Hs.eg.db)
lrt$genes
read.csv("AnnotTable.csv") -> annot
left_join(lrt$genes,annot,
join_by(genes == ENSEMBL)) -> lrt$genes
lrt$genes
goana(lrt,
geneid = lrt$genes$ENTREZID,
species = "Hs",
FDR = 0.05) -> goana_res
str(goana_res)
head(goana_res)
dim(goana_res)
p.adjust(goana_res$P.Up,
method = "fdr") -> goana_res$P.Up.adj
p.adjust(goana_res$P.Down,
method = "fdr") -> goana_res$P.Down.adj
head(goana_res)
dim(goana_res %>%
filter(P.Up < 0.05 & Ont == "BP")) # 2547
dim(goana_res %>%
filter(P.Up.adj < 0.05 & Ont == "BP")) # 1321
dim(goana_res %>%
filter(P.Up.adj < 0.05)) # 1523
topGO(goana_res)
hist(goana_res$N) # column N shows the number of genes in a GO term
hist(goana_res$N[goana_res$N < 1000])
hist(goana_res$N[goana_res$N < 200])
goana_res %>%
filter(Ont == "BP" & N < 200 & P.Up.adj < 0.05) -> goana_res_filt
goana_res %>%
filter(Ont == "BP" & N < 200 & P.Up.adj < 0.05) -> goana_res_filt
goana_res_filt %>%
slice_min( # "slices" N number of rows with minimum values based on a variable
n = 10, # number of rows to slice
order_by = P.Up.adj # variable to order by
)
goana_res %>%
filter(P.Up.adj < 0.05 & P.Up.adj > 0.049)
goana_res %>%
filter(row.names(goana_res) == "GO:0050868")
goana_res %>%
filter(row.names(goana_res) %in% c("GO:0009062","GO:0046349","GO:0010803"))
View(goana_res_filt)
View(goana_res)
goana_res %>%
filter(P.Down.adj < 0.05)
View(annot)
sessionInfo()
BiocManager::version()
BiocManager::available()
