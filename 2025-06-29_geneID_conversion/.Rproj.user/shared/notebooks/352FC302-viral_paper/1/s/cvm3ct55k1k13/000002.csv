"1","<!-- KNITR_ASIS_OUTPUT_TOKEN -->
<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxubGVmdF9qb2luKGFsbERmLGNuKSAlPiVcbiAgbGVmdF9qb2luKC4sbl92aXJ1c2VzKSAlPiVcbiAgbXV0YXRlKG51bWJlcl92aXJ1c2VzID0gaWZfZWxzZShpcy5uYShudW1iZXJfdmlydXNlcyksMCxudW1iZXJfdmlydXNlcykpICU+JVxuICBmaWx0ZXIoaW5kZXggJWluJSBzaW5zcHUpICU+JVxuICBmaWx0ZXIoZ2VudXMgPT0gXCJQc2V1ZG9tb25hc1wiKSAlPiVcbiAgbXV0YXRlKFBzZXVkb19hYnVuZGFuY2UgPSAobWVhbl9jbioocmVsX2FiLzEwMCkpLzQpICU+JSAjIFBhIGhhcyA0IDE2UyBjb3BpZXMgcGVyIGdlbm9tZVxuICBmaWx0ZXIoUHNldWRvX2FidW5kYW5jZSA+PSAxKSAlPiVcbiAgZ3JvdXBfYnkoc2FtcGxlbG9jLG51bWJlcl92aXJ1c2VzKSAlPiVcbiAgaWRlbnRpZnlfb3V0bGllcnMoUHNldWRvX2FidW5kYW5jZSkgJT4lXG4gIC4kaW5kZXggLT4gUGFBYnVuZGFuY2VPdXRsaWVyc1xuICBcbmxlZnRfam9pbihhbGxEZixjbikgJT4lXG4gIGxlZnRfam9pbiguLG5fdmlydXNlcykgJT4lXG4gIG11dGF0ZShudW1iZXJfdmlydXNlcyA9IGlmX2Vsc2UoaXMubmEobnVtYmVyX3ZpcnVzZXMpLDAsbnVtYmVyX3ZpcnVzZXMpKSAlPiVcbiAgZmlsdGVyKGluZGV4ICVpbiUgc2luc3B1KSAlPiVcbiAgZmlsdGVyKGdlbnVzID09IFwiUHNldWRvbW9uYXNcIikgJT4lXG4gIG11dGF0ZShQc2V1ZG9fYWJ1bmRhbmNlID0gKG1lYW5fY24qKHJlbF9hYi8xMDApKS80KSAlPiUgIyBQYSBoYXMgNCAxNlMgY29waWVzIHBlciBnZW5vbWVcbiAgZmlsdGVyKFBzZXVkb19hYnVuZGFuY2UgPj0gMSkgJT4lXG4gIG11dGF0ZShvdXRsaWVyID0gaWZfZWxzZShpbmRleCAlaW4lIFBhQWJ1bmRhbmNlT3V0bGllcnMsVFJVRSxGQUxTRSkpICU+JVxuICBnZ3Bsb3QoYWVzKHggPSBudW1iZXJfdmlydXNlcyxcbiAgICAgICAgICAgICB5ID0gUHNldWRvX2FidW5kYW5jZSxcbiAgICAgICAgICAgICBjb2xvciA9IHNhbXBsZWxvYykpICtcbiAgZ2VvbV9ib3hwbG90KGFlcyhncm91cCA9IG51bWJlcl92aXJ1c2VzKSxcbiAgICAgICAgICAgICAgIG91dGxpZXJzID0gRkFMU0UpICtcbiAgZ2VvbV9wb2ludChhZXMoc2hhcGUgPSBvdXRsaWVyKSkgKyBcbiAgc2NhbGVfeV9sb2cxMCgpICtcbiAgc2NhbGVfY29sb3JfbWFudWFsKHZhbHVlcyA9IGMoXCJnb2xkXCIsXCJzcHJpbmdncmVlbjNcIikpICtcbiAgc2NhbGVfc2hhcGVfbWFudWFsKHZhbHVlcyA9IGMoMTYsMSkpICtcbiAgbGFicyh4ID0gXCJOdW1iZXIgb2YgdmlyYWwgaW5mZWN0aW9ucyBwZXIgc3ViamVjdFwiLFxuICAgICAgIHkgPSBcIipQc2V1ZG9tb25hcyogc3BwLiBhYnVuZGFuY2VcIikgK1xuICBmYWNldF93cmFwKH5zYW1wbGVsb2MsXG4gICAgICAgICAgICAgbGFiZWxsZXIgPSBhc19sYWJlbGxlcihjKFwic2ludXNcIiA9IFwiU2ludXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzcHV0dW1cIiA9IFwiU3B1dHVtXCIpKSkgK1xuICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSBcIm5vbmVcIixcbiAgICAgICAgYXhpcy50aXRsZS55ID0gZWxlbWVudF9tYXJrZG93bigpKVxuYGBgIn0= -->

```r
left_join(allDf,cn) %>%
  left_join(.,n_viruses) %>%
  mutate(number_viruses = if_else(is.na(number_viruses),0,number_viruses)) %>%
  filter(index %in% sinspu) %>%
  filter(genus == \"Pseudomonas\") %>%
  mutate(Pseudo_abundance = (mean_cn*(rel_ab/100))/4) %>% # Pa has 4 16S copies per genome
  filter(Pseudo_abundance >= 1) %>%
  group_by(sampleloc,number_viruses) %>%
  identify_outliers(Pseudo_abundance) %>%
  .$index -> PaAbundanceOutliers
  
left_join(allDf,cn) %>%
  left_join(.,n_viruses) %>%
  mutate(number_viruses = if_else(is.na(number_viruses),0,number_viruses)) %>%
  filter(index %in% sinspu) %>%
  filter(genus == \"Pseudomonas\") %>%
  mutate(Pseudo_abundance = (mean_cn*(rel_ab/100))/4) %>% # Pa has 4 16S copies per genome
  filter(Pseudo_abundance >= 1) %>%
  mutate(outlier = if_else(index %in% PaAbundanceOutliers,TRUE,FALSE)) %>%
  ggplot(aes(x = number_viruses,
             y = Pseudo_abundance,
             color = sampleloc)) +
  geom_boxplot(aes(group = number_viruses),
               outliers = FALSE) +
  geom_point(aes(shape = outlier)) + 
  scale_y_log10() +
  scale_color_manual(values = c(\"gold\",\"springgreen3\")) +
  scale_shape_manual(values = c(16,1)) +
  labs(x = \"Number of viral infections per subject\",
       y = \"*Pseudomonas* spp. abundance\") +
  facet_wrap(~sampleloc,
             labeller = as_labeller(c(\"sinus\" = \"Sinus\",
                                      \"sputum\" = \"Sputum\"))) +
  theme(legend.position = \"none\",
        axis.title.y = element_markdown())
```

<!-- rnb-source-end -->
<!-- KNITR_ASIS_OUTPUT_TOKEN -->"
"0","```r
left_join(allDf,cn) %>%
  left_join(.,n_viruses) %>%
  mutate(number_viruses = if_else(is.na(number_viruses),0,number_viruses)) %>%
  filter(index %in% sinspu) %>%
  filter(genus == \"Pseudomonas\") %>%
  mutate(Pseudo_abundance = (mean_cn*(rel_ab/100))/4) %>% # Pa has 4 16S copies per genome
  filter(Pseudo_abundance >= 1) %>%
  group_by(sampleloc,number_viruses) %>%
  identify_outliers(Pseudo_abundance) %>%
  .$index -> PaAbundanceOutliers
  
left_join(allDf,cn) %>%
  left_join(.,n_viruses) %>%
  mutate(number_viruses = if_else(is.na(number_viruses),0,number_viruses)) %>%
  filter(index %in% sinspu) %>%
  filter(genus == \"Pseudomonas\") %>%
  mutate(Pseudo_abundance = (mean_cn*(rel_ab/100))/4) %>% # Pa has 4 16S copies per genome
  filter(Pseudo_abundance >= 1) %>%
  mutate(outlier = if_else(index %in% PaAbundanceOutliers,TRUE,FALSE)) %>%
  ggplot(aes(x = number_viruses,
             y = Pseudo_abundance,
             color = sampleloc)) +
  geom_boxplot(aes(group = number_viruses),
               outliers = FALSE) +
  geom_point(aes(shape = outlier)) + 
  scale_y_log10() +
  scale_color_manual(values = c(\"gold\",\"springgreen3\")) +
  scale_shape_manual(values = c(16,1)) +
  labs(x = \"Number of viral infections per subject\",
       y = \"*Pseudomonas* spp. abundance\") +
  facet_wrap(~sampleloc,
             labeller = as_labeller(c(\"sinus\" = \"Sinus\",
                                      \"sputum\" = \"Sputum\"))) +
  theme(legend.position = \"none\",
        axis.title.y = element_markdown())
```"
